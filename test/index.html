<!DOCTYPE html>
<html lang="zh-cn">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>测试页面</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@hai2007/style@0/normalize.css">
</head>

<body>

    <h2>测试页面</h2>


    <script>

        const ws = new WebSocket('ws://localhost:20001/refresh-page');
        let flag = false;

        // 连接成功
        ws.addEventListener('open', function (event) {
            ws.send('服务器，你好呀！');
        });

        // 监听来自服务器的数据
        ws.addEventListener('message', function (event) {
            if (!flag) { flag = true; return; }

            console.log('来自ws服务器的数据：', event.data);

            // 如果把该方法的参数设置为 true，那么无论文档的最后修改日期是什么，
            // 它都会绕过缓存，从服务器上重新下载该文档
            window.location.reload(true);

        });

    </script>
</body>

</html>
